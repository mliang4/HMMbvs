<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Mingrui Liang, Matthew D. Koslovsky, Emily T. Hebert, Darla E. Kendzor, Michael S. Businelle, Marina Vannucci" />


<title>HMMbvs-vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">HMMbvs-vignette</h1>
<h4 class="author">Mingrui Liang, Matthew D. Koslovsky, Emily T. Hebert, Darla E. Kendzor, Michael S. Businelle, Marina Vannucci</h4>



<p>In this tutorial, we demonstrate how to implement Bayesian variable selection for both HMMs and MSMs using our contributed R package <code>HMMbvs</code>. Since the true relations between covariates and outcomes are unknown in practice, we chose to apply our model to simulated data in order to display its selection performance.</p>
<div id="install-the-package" class="section level2">
<h2>Install the package</h2>
<p>Prior to installing the <code>HMMbvs</code> package, make sure the following packages are installed and loaded in R: <code>Rcpp</code>, <code>RcppArmadillo</code>, <code>msm</code>, <code>MASS</code>, <code>coda</code>, <code>reshape</code>, <code>abind</code>, <code>devtools</code>, <code>ggplot2</code>. Then to install <code>HMMbvs</code>, run</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;mliang4/HMMbvs&quot;</span>)</a></code></pre></div>
<p>in the R console. Once the package is installed, it is loaded into the R environment by simply running</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(HMMbvs)</a></code></pre></div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>In this section, we describe the data structure required to run our proposed method using the <code>HMMbvs_R()</code> function. Data are inputted into the function as a <code>data.frame</code> object in the long format, where each row corresponds to the <span class="math inline">\(j^{th}\)</span>, <span class="math inline">\(j = 1, \dots, n_i\)</span>, observation from the <span class="math inline">\(i^{th}\)</span>, <span class="math inline">\(i = 1, \dots, \dot{N}\)</span>, subject. Note that the <code>HMMbvs_R()</code> function requires the observations for each subject to be in chronological order, but the order of the subjects does not matter. To run, the dataset must contain (at the very least) three columns representing the subject ID, <code>&quot;id&quot;</code>, observed state, <code>&quot;y&quot;</code>, and observation time, <code>&quot;obstime&quot;</code> for each observation. While there is no specific order for the columns in the dataset, the subject IDs should be numeric, the observed state should only take on values of 0 or 1, and the observation times should be positive real numbers. Additional columns in the dataset represent the corresponding covariates collected at the <span class="math inline">\(ij^{th}\)</span> assessment. Note that these can be both baseline and time-varying covariates. Prior to analysis, categorical covariates should be transformed into indicator variables and labeled appropriately.</p>
<p>Our package includes functionality to simulate data similar to our simulation and sensitivity analysis, which we use to demonstrate how to apply our method. To simulate data, run</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">set.seed</span>(<span class="dv">125</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">df =<span class="st"> </span><span class="kw">sim_data</span>( <span class="dt">ind =</span> <span class="dv">150</span>, <span class="dt">window =</span> <span class="dv">30</span>, <span class="dt">lambda_0 =</span> <span class="fl">0.5</span>, <span class="dt">mu_0 =</span> <span class="fl">0.5</span>, <span class="dt">emisP0 =</span> <span class="fl">0.95</span>, <span class="dt">emisP1 =</span> <span class="fl">0.95</span>, </a>
<a class="sourceLine" id="cb3-3" title="3">      <span class="dt">pt =</span> <span class="dv">30</span>, <span class="dt">pe =</span> <span class="dv">20</span>, <span class="dt">bval =</span> <span class="kw">c</span>(<span class="fl">0.7</span>,<span class="fl">1.0</span>,<span class="fl">1.5</span>), <span class="dt">biased =</span> <span class="ot">TRUE</span> )</a></code></pre></div>
<p>Here, <code>set.seed(125)</code> seeds the random number generator to make the simulation reproducible. By default, a dataset with 150 individuals (<code>ind = 150</code>), each with 30 transitions (<code>window = 30</code>), is generated with 30 transitions and 20 emissions covariates (<code>pt = 30, pe = 20</code> respectively). The first four transitions covariates and the first two emissions covariates are binary. The rest of the covariates are simulated from a normal distribution and standardized. This implies a total of 100 potential regression terms across both levels of the model, not including intercept terms. In the true model, 20% of the regression terms are active, and their effects are randomly chosen from <span class="math inline">\(\pm 0.7\)</span>, <span class="math inline">\(\pm 1.0\)</span> or <span class="math inline">\(\pm 1.5\)</span> (<code>bval = c(0.7,1.0,1.5)</code>). The baseline hazard rates for transitions in both directions are set to 0.5 by default (<code>lambda_0 = 0.5, mu_0 = 0.5</code>). The baseline probability of reporting a true non-smoking or smoking behavior (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, respectively) are set to <span class="math inline">\(logit(.95)\)</span>, reflecting a 95% accuracy level for both non-smoking and smoking states (<code>emisP0 = 0.95, emisP1 = 0.95</code>). Naturally, our simulated data will be biased (<code>biased = TRUE</code>) by default. We can set this argument to (<code>biased = FALSE</code>), to replace the biased observation with the true hidden state sequence (i.e. 100% accurate observation). The following 11 rows of output from the simulated <code>df</code> object display the last six observations for subject ID 1 and the first five observations for subject ID 2 simulated by the <code>sim_data()</code> function</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">print</span>(df<span class="op">$</span>DATA[<span class="dv">26</span><span class="op">:</span><span class="dv">36</span>,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">51</span>,<span class="dv">52</span>,<span class="dv">53</span>)],<span class="dt">row.names =</span> F)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;  id tVar1 tVar2     tVar30 eVar1 eVar2     eVar20 y    obstime</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 27.7213073</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.2577059</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.5202212</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.5304124</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 0 29.8044472</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 29.8986442</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 1  0.0000000</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  0.2207321</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  1.7897745</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  2.0517698</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  2.3852817</span></a></code></pre></div>
<p>where <code>df$DATA</code> extracts the simulated data from the <code>df</code> object. Note that the simulated covariates for transitions <code>&quot;tVar3&quot;</code> to <code>&quot;tVar29&quot;</code> and emissions <code>&quot;eVar3&quot;</code> to <code>&quot;eVar19&quot;</code> are suppressed for demonstration purposes. The output of <code>sim_data()</code> also contains the true regression coefficients and the true hidden state sequence. They can be extracted by running</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">trueBeta =<span class="st"> </span>df<span class="op">$</span>BETA</a>
<a class="sourceLine" id="cb5-2" title="2">trueState =<span class="st"> </span>df<span class="op">$</span>STATE</a></code></pre></div>
<p>An unbiased dataset can be generated by simply changing the <code>biased</code> argument to <code>FALSE</code> as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">set.seed</span>(<span class="dv">125</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">df1 =<span class="st"> </span><span class="kw">sim_data</span>( <span class="dt">ind =</span> <span class="dv">150</span>, <span class="dt">window =</span> <span class="dv">30</span>, <span class="dt">lambda_0 =</span> <span class="fl">0.5</span>, <span class="dt">mu_0 =</span> <span class="fl">0.5</span>, <span class="dt">emisP0 =</span> <span class="fl">0.95</span>, <span class="dt">emisP1 =</span> <span class="fl">0.95</span>, </a>
<a class="sourceLine" id="cb6-3" title="3">      <span class="dt">pt =</span> <span class="dv">30</span>, <span class="dt">pe =</span> <span class="dv">20</span>, <span class="dt">bval =</span> <span class="kw">c</span>(<span class="fl">0.7</span>,<span class="fl">1.0</span>,<span class="fl">1.5</span>), <span class="dt">biased =</span> <span class="ot">FALSE</span> )</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">print</span>(df1<span class="op">$</span>DATA[<span class="dv">26</span><span class="op">:</span><span class="dv">36</span>,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">51</span>,<span class="dv">52</span>,<span class="dv">53</span>)],<span class="dt">row.names =</span> F)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt;  id tVar1 tVar2     tVar30 eVar1 eVar2     eVar20 y    obstime</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 27.7213073</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.2577059</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.5202212</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 28.5304124</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 29.8044472</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt;   1     0     0 -0.9601369     0     0  1.2491446 1 29.8986442</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 1  0.0000000</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  0.2207321</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  1.7897745</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  2.0517698</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt;   2     0     0 -1.3292270     0     0 -0.4940494 0  2.3852817</span></a></code></pre></div>
<p>We can see that the observation <span class="math inline">\(y\)</span>, which is the true state sequence here, is different from the one in the previous dataset.</p>
</div>
<div id="implementation-of-the-mcmc-algorithm" class="section level2">
<h2>Implementation of the MCMC Algorithm</h2>
<p>To generate MCMC samples for the HMM applied to the data simulated in the previous section, run</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">hmmout =<span class="st"> </span><span class="kw">HMMbvs_R</span>( <span class="dt">data =</span> df<span class="op">$</span>DATA, </a>
<a class="sourceLine" id="cb8-2" title="2">            <span class="dt">tcova =</span> <span class="kw">c</span>( <span class="st">&quot;tVar1&quot;</span>, <span class="st">&quot;tVar2&quot;</span>, <span class="st">&quot;tVar3&quot;</span>, <span class="st">&quot;tVar4&quot;</span>, <span class="st">&quot;tVar5&quot;</span>, <span class="st">&quot;tVar6&quot;</span>, <span class="st">&quot;tVar7&quot;</span>, <span class="st">&quot;tVar8&quot;</span>,</a>
<a class="sourceLine" id="cb8-3" title="3">                       <span class="st">&quot;tVar9&quot;</span>, <span class="st">&quot;tVar10&quot;</span>, <span class="st">&quot;tVar11&quot;</span>, <span class="st">&quot;tVar12&quot;</span>, <span class="st">&quot;tVar13&quot;</span>, <span class="st">&quot;tVar14&quot;</span>, <span class="st">&quot;tVar15&quot;</span> ), </a>
<a class="sourceLine" id="cb8-4" title="4">            <span class="dt">ecova =</span> <span class="kw">c</span>( <span class="st">&quot;eVar1&quot;</span>, <span class="st">&quot;eVar2&quot;</span>, <span class="st">&quot;eVar3&quot;</span>, <span class="st">&quot;eVar4&quot;</span>, <span class="st">&quot;eVar5&quot;</span>, <span class="st">&quot;eVar6&quot;</span>, <span class="st">&quot;eVar7&quot;</span> ), </a>
<a class="sourceLine" id="cb8-5" title="5">            <span class="dt">tforce =</span> <span class="ot">NULL</span>, <span class="dt">eforce =</span> <span class="ot">NULL</span>, <span class="dt">standardize =</span> <span class="ot">NULL</span>, <span class="dt">model =</span> <span class="st">&quot;HMM&quot;</span>, <span class="dt">init =</span> <span class="st">&quot;baseline&quot;</span>, </a>
<a class="sourceLine" id="cb8-6" title="6">            <span class="dt">initvalue =</span> <span class="ot">NULL</span>, <span class="dt">iter =</span> <span class="dv">25000</span>, <span class="dt">v1 =</span> <span class="dv">5</span>, <span class="dt">v2 =</span> <span class="dv">1</span>, <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">9</span>, <span class="dt">thin =</span> <span class="dv">10</span>, <span class="dt">thin_hidden =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-7" title="7">            <span class="dt">base01larger=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">base00larger=</span><span class="op">-</span><span class="dv">1</span>)</a></code></pre></div>
<p>The first three arguments are required for the model to run. In this example, <code>data = df$DATA</code> indicates the dataset to be analyzed. The <code>tcova</code> and <code>ecova</code> arguments correspond to the column names in the dataset to include in the transitions and emissions parts of the the model, respectively. They are set to a list of zero length (the <code>NULL</code> object in <code>R</code>) by default and they accept either a vector or a named list of two vectors as input. This allows the user to control which covariates may be associated with different parts of the model. For example, even though there are 30 transitions and 20 emissions covariates included in the <code>df$DATA</code> dataset, we only include <code>tVar1</code> to <code>tVar15</code> and <code>eVar1</code> to <code>eVar7</code> in the model. If a vector is supplied, as in our example, then the covariates named in <code>tcova</code> may affect both transitions (i.e., <span class="math inline">\(0 \rightarrow 1\)</span> and <span class="math inline">\(1 \rightarrow 0\)</span>). Similarly, all of the covariates in <code>ecova</code> are included in both emissions models. If it is of interest to include different covariates for each of the transitions or emissions components in the model, then a list of two vectors, can be provided. For example, the following setup</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">tcova =<span class="st"> </span><span class="kw">list</span>( <span class="st">&quot;t01&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;tVar1&quot;</span>, <span class="st">&quot;tVar2&quot;</span>, <span class="st">&quot;tVar3&quot;</span>, <span class="st">&quot;tVar4&quot;</span>, <span class="st">&quot;tVar5&quot;</span>, <span class="st">&quot;tVar6&quot;</span> ),</a>
<a class="sourceLine" id="cb9-2" title="2">              <span class="st">&quot;t10&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;tVar3&quot;</span>, <span class="st">&quot;tVar4&quot;</span>, <span class="st">&quot;tVar5&quot;</span>, <span class="st">&quot;tVar6&quot;</span> ) )</a>
<a class="sourceLine" id="cb9-3" title="3">ecova =<span class="st"> </span><span class="kw">list</span>( <span class="st">&quot;e00&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;eVar1&quot;</span>, <span class="st">&quot;eVar2&quot;</span>, <span class="st">&quot;eVar3&quot;</span>, <span class="st">&quot;eVar4&quot;</span> ),</a>
<a class="sourceLine" id="cb9-4" title="4">              <span class="st">&quot;e11&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;eVar2&quot;</span>, <span class="st">&quot;eVar4&quot;</span>, <span class="st">&quot;eVar6&quot;</span> ) )</a></code></pre></div>
<p>implies that only covariates <code>tVar</code> 1-6 may influence transitions from state 0 to 1, <code>&quot;t01&quot;</code>, and covariates <code>tVar</code> 3-6 may influece transitions from state 1 to 0, <code>&quot;t10&quot;</code>. Similarly, <code>e00</code> and <code>e11</code> indicate the covariates potentially associated with accurately reporting outcomes. By default, all items provided in <code>tcova</code> and <code>ecova</code> are subject to selection. Users can force covariates into the model by using the <code>tforce</code> and <code>eforce</code> arguments. For example,</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">tforce =<span class="st"> </span><span class="kw">list</span>( <span class="st">&quot;tf01&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;tVar2&quot;</span>, <span class="st">&quot;tVar4&quot;</span> ),</a>
<a class="sourceLine" id="cb10-2" title="2">               <span class="st">&quot;tf10&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;tVar4&quot;</span>, <span class="st">&quot;tVar7&quot;</span>, <span class="st">&quot;tVar8&quot;</span> ) )</a>
<a class="sourceLine" id="cb10-3" title="3">eforce =<span class="st"> </span><span class="kw">list</span>( <span class="st">&quot;ef00&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;eVar2&quot;</span> ) )</a></code></pre></div>
<p>forces <code>tVar</code> 2 and 4 to be associated with transitions from state 0 to state 1 and <code>tVar</code> 4, 7, and 8 to be associated with transitions from 1 to 0. These arguments can handle a named list of size one or two as input. For example, <code>eVar2</code> is forced into the model for emissions from state 0, but all covariates are free to be selected in the model for emissions from state 1. In practice, we suggest that all continuous covariates are standardized prior to analysis. Users can provide a vector of variable names to standardize via the <code>standardize</code> argument.</p>
<p>Our function can run both HMM (<code>model = &quot;HMM&quot;</code>) or MSM (<code>model = &quot;MSM&quot;</code>), with the HMM run by default. Additionally, the user has control over how the MCMC sampler is initialized. By default, non-intercept regression coefficients will be initiated at 0 by <code>init = &quot;baseline&quot;</code>. Alternatively, one can use <code>init = &quot;warmstart&quot;</code> to initiate the regression terms at the maximum likelihood estimates provided by the <code>msm</code> package in <code>R</code>. The model can also be initialized with manual input (<code>init = &quot;manual&quot;</code>). For example to initialize all the intercept terms at 0.5 and all of the regression terms corresponding to the restricted covariate space in the above example at one, run</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">initValue =<span class="st"> </span><span class="kw">list</span>( <span class="st">&quot;init01&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="fl">0.5</span>, <span class="kw">rep</span>( <span class="dv">1</span>, <span class="dv">6</span> )),</a>
<a class="sourceLine" id="cb11-2" title="2">                   <span class="st">&quot;init10&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="fl">0.5</span>, <span class="kw">rep</span>( <span class="dv">1</span>, <span class="dv">4</span> )),</a>
<a class="sourceLine" id="cb11-3" title="3">                   <span class="st">&quot;init00&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="fl">0.5</span>, <span class="kw">rep</span>( <span class="dv">1</span>, <span class="dv">4</span> )),</a>
<a class="sourceLine" id="cb11-4" title="4">                   <span class="st">&quot;init11&quot;</span> =<span class="st"> </span><span class="kw">c</span>( <span class="fl">0.5</span>, <span class="kw">rep</span>( <span class="dv">1</span>, <span class="dv">3</span> )) )</a></code></pre></div>
<p>and set the <code>initvalue</code> argument in the <code>HMMbvs</code> function to <code>initValue</code>. Here, <code>initvalue</code> accepts a list of size four, and the dimension of each element in the list must match the dimension of the corresponding element in <code>tcova</code> and <code>ecova</code> plus one, where the first value of each element corresponds to the initialization of the intercept.</p>
<p>In this example, we set the number of MCMC iterations to run as 25,000 (<code>iter = 25000</code>). The number of iterations can be determined based on the convergence of the model. The default values for the prior variance and the proposal variance are five (<code>v1 = 5</code>) and one (<code>v2 = 1</code>), respectively. The prior variance indicates how diffuse the prior distribution for active regression coefficients is. For example, <code>v1 = 5</code> places a 95% prior probability of included regression coefficients between a hazards/odds ratio of 0.01 and 80. The default hyperparameters for the prior inclusion indicators are <code>a = 1, b = 9</code>, where <span class="math inline">\(\frac{a}{a+b}\)</span> reflects the prior belief regarding the proprotion of covariates active in the model. Due to the potentially large parameter space of the model, the MCMC chains may require more memory than available. For example, in our simulation study (150 subjects with 30 transitions for each subject and 25,000 MCMC iterations), the hidden states alone would require about 1 Gb of memory. For a quick estimate of the memory required for model output, a dataset with 100,000 cells would require 0.8 Mb of space. To help manage memory storage, the user can control the amount of thinning with the <code>thin</code> and <code>thin_hidden</code> arguments. By default, the regression coefficient and hidden state MCMC samples are thinned to every 10<span class="math inline">\(^{th}\)</span> iteration, <code>thin = 10</code> and <code>thin_hidden = 10</code>, respectively. Finally, to deal with the potential label switching issue, we can use <code>base01larger</code> and/or <code>base00larger</code> to force one of the intercept terms in the transition and/or the emission to be larger than the other. By default their values are set to <code>-1</code>, meaning that there are no constraints enforced. We can set <code>base01larger=1</code> (or <code>0</code>) such that <span class="math inline">\(\lambda_0&gt;\mu_0\)</span> (or <span class="math inline">\(&lt;\)</span>) in the model. Similarly, <code>base00larger=1</code> (or <code>0</code>) implies <span class="math inline">\(\beta_{0,N}&gt;\beta_{0,S}\)</span> (or <span class="math inline">\(&lt;\)</span>).</p>
<p>To run an MSM, set <code>model = &quot;msm&quot;</code> and the emission-related arguments (<code>ecova, eforce</code>) to their default values as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">msmout =<span class="st"> </span><span class="kw">HMMbvs_R</span>( <span class="dt">data =</span> df1<span class="op">$</span>DATA, </a>
<a class="sourceLine" id="cb12-2" title="2">            <span class="dt">tcova =</span> <span class="kw">c</span>( <span class="st">&quot;tVar1&quot;</span>, <span class="st">&quot;tVar2&quot;</span>, <span class="st">&quot;tVar3&quot;</span>, <span class="st">&quot;tVar4&quot;</span>, <span class="st">&quot;tVar5&quot;</span>, <span class="st">&quot;tVar6&quot;</span>, <span class="st">&quot;tVar7&quot;</span>, <span class="st">&quot;tVar8&quot;</span>,</a>
<a class="sourceLine" id="cb12-3" title="3">                       <span class="st">&quot;tVar9&quot;</span>, <span class="st">&quot;tVar10&quot;</span>, <span class="st">&quot;tVar11&quot;</span>, <span class="st">&quot;tVar12&quot;</span>, <span class="st">&quot;tVar13&quot;</span>, <span class="st">&quot;tVar14&quot;</span>, <span class="st">&quot;tVar15&quot;</span> ), </a>
<a class="sourceLine" id="cb12-4" title="4">            <span class="dt">ecova =</span> <span class="ot">NULL</span>, <span class="dt">tforce =</span> <span class="ot">NULL</span>, <span class="dt">eforce =</span> <span class="ot">NULL</span>, <span class="dt">standardize =</span> <span class="ot">NULL</span>, <span class="dt">model =</span> <span class="st">&quot;MSM&quot;</span>, </a>
<a class="sourceLine" id="cb12-5" title="5">            <span class="dt">init =</span> <span class="st">&quot;baseline&quot;</span>, <span class="dt">initvalue =</span> <span class="ot">NULL</span>, <span class="dt">iter =</span> <span class="dv">5000</span>, <span class="dt">v1 =</span> <span class="dv">5</span>, <span class="dt">v2 =</span> <span class="dv">1</span>, <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">9</span>, </a>
<a class="sourceLine" id="cb12-6" title="6">            <span class="dt">thin =</span> <span class="dv">10</span>, <span class="dt">thin_hidden =</span> <span class="dv">10</span> )</a></code></pre></div>
<p>From our experience, MSMs require less iterations for convergence. Thus, in this example we reduce the number of iterations to 5,000. Additionally, note that the <code>thin_hidden</code> will be ignored when the function is specified for MSMs.</p>
</div>
<div id="convergence-and-model-fit" class="section level2">
<h2>Convergence and Model Fit</h2>
<p>Prior to analyzing the model output, we recommend assessing convergence and goodness-of-fit for the model. There are numerous ways to assess the covergence of the MCMC algorithm. A standard approach for visually assessing model convergence is to generate trace plots for each coefficient in the model. To make trace plots for the posterior samples of each regression coefficient, we take advantage of the <code>coda</code> package in R. For the large model spaces typically found in variable selection research, an alternative way to visually assess overall convergence of the model is to plot the joint log-likelihood of observed and hidden states and/or the number of covariates active in the model as a function of MCMC iterations. Convergence is determined once these plots have stabilized across MCMC iterations. Our package contains a function to generate each of these plots,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">convergence</span>( <span class="dt">output =</span> hmmout, <span class="dt">file =</span> <span class="st">&quot;convergence.pdf&quot;</span>)</a></code></pre></div>
<p>which requires the output from the <code>HMMbvs()</code> function, (<code>output = hmmout</code>), and the name of the pdf file, (<code>file = &quot;convergence.pdf&quot;</code>), where the plots will be saved in the current working directory in R. By adjusting the input for the <code>file</code> argument, users can also save this pdf file elsewhere. For example, set <code>file = &quot;&lt;path&gt;/convergence.pdf&quot;</code>. For more advanced usage of the <code>file</code> argument, please refer to the documentation of the <code>pdf()</code> function in R.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The first two pages of the generated pdf document contain plots of the joint log-likelihood and the total number of covariates included across all MCMC iterations. These two plots can be used to determine if the number of MCMC iterations is sufficient (i.e., the plots have stabilized) and how many iterations should be discarded prior to convergence (also known as the burn-in). In our example, the MCMC iterations are thinned to every 10<span class="math inline">\(^{th}\)</span> iteration, and both of the plots seem to converge by the 1,000<span class="math inline">\(^{th}\)</span> iteration. Thus, we will use a burn-in of 1,000 iterations, using the remaining 1,500 for inference.</p>
<p>The subsequent pages in the pdf correspond to trace plots for each of the regression coefficients. Trace plot titles are formatted as <em>process</em>_<em>variable</em> to indicate the transition or emissions direction and the name of the variable. The bottom left figure above shows an example of one of the trace plots produced. The title indicates that it is the trace plot for covariate “tVar6” modeling the transition from 0 to 1.</p>
<p>To generate plots to assess the convergence of an MSM, change the <code>output</code> argument to <code>output = msmout</code> and rename the pdf output file accordingly.</p>
<p>To assess goodness-of-fit for Bayesian models with discrete outcomes, Gelman et al. (2000) recommend posterior predictive checks (PPCs) that compare replicated data sets from the posterior predictive distribution of the model to the observed data. For each replicated data set, a discrepancy variable (e.g., the total number of observed smoking states), is compared to the observed data. In theory, the model fit these data well, if the discrepancy variable calculated on the observed data appears to of been generated by the model. To generate PPCs, we take advantage of the <code>Bayesplot</code> package in R. In this example using the <code>ppc</code> function,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">ypost =<span class="st"> </span><span class="kw">ppc</span>( <span class="dt">output =</span> hmmout, <span class="dt">file =</span> <span class="st">&quot;sum_one.pdf&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;sum_one&quot;</span>, <span class="dt">burnin =</span> <span class="dv">1000</span>, <span class="dt">postsample =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArMAAAKzCAMAAAA6OXUpAAABVlBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYBH0szMzM6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjo5NjshmAABmADpmAGZmOgBmOjpmOpBmZmZmZrZmkLZmkNtmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6ObquOjk2Oq+SOyP+QOgCQOjqQOmaQZjqQZpCQkLaQtpCQttuQtv+Q29uQ2/+rbk2rq8ir5OSr5P+zzeC2ZgC2Zjq2Zma2kDq2kGa2kJC225C227a229u22/+2/7a2/9u2///Ijk3Ijo7IyP/I///R4ezbkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb/9vb///kq27kq47k////tmb/tpD/trb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+e5G/xAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAYuElEQVR4nO3d/Xvb1n2GcchRtcrtmsarvHXR5m5tFnZtsjcr87qsShfTaffiVNkypu6SVW64Ra5lhv//L8M5AEiQIh9DwYH1HPm+r6uS9TUPDyp8QkG0RRdzorwqrvoAiC4ZZim3MEu5hVnKLcxSbmGWcguzlFuXNDv7xTdOOt7w5nG3u/z1nWLnzcsdxSWbPfrmwXz+4MbJc29DOdQ2Oy0Wjdq3+eCkdRN55peNi51uZqc3Hs7u7Z5u2W/tg7LZ0d5p+E8iEqs+eF6Torhgdv1uq9tQDq2YLenMjuKbttmz9kPruKPZ+aSj2fHuurqV/c7WH9fPD8MBvrMficUPnt/Z/rrHC3e74TZkWtvs/x7PK7Pzs5bZ2VGbaWqz1X6rk9YWq5tXk73wriJWf/C8Lni8eLeYzaf169mloSffK4pvPSwH5aXCjZMnd4rilZOl2d89+MYv75WT8rdvnJwfFnuLydmd4rXTYPan94qd74TbfrJfvPIw/P6Hd9buvLocqe/yvFz42fdX9qs/qO+hahxt1cTGNbTy8vmnD4ri1ulim2ZJeUev/Gt549mj8NAa9n314frdNrehLNpq9vzwzfmTo/BgGZieH+6dnu3vLcyWZ33nB3ESH7LODveaybffnT8Kl8OTUu7s56Xl+eTW6ZPDG78sf//NRw3PxZ23HmfHb8xn471N+1X3UC2dfxK/BtRmP6m/IJSXz689LPeMhxG2aZaE25UkD6or8bOb75aTcseVu13chrJoq9mgZ75gc354UP3W4tog/CJ+ab74i+ipujYoZ+d/ehIEj9qXFcs7X5o9Pyz9nX9/w36Le2i1/qV8sV21zXLTsNM0eCzns6Ow6EF9ow23oRzaZjagmbcQzOeffa+4vNlpMaqfjThomW3d+dJs+Qj52sNmvLLf4h5abTa7+E+jWXK2P2puXM6rj5o9NtyGcmib2foUThqzT+688m9f4XE2mG2vqGrdeevaYHaviJeXF/abLh+gF202O12YrZdMC2H24m0oh7Y/zsbvyBuz54e3vtK1Qfl22nxRbz/OLu585XmD3z0oNu03Xb0siG0xW76tH2erJdVX/KXZ5mmG9t22bkM5tP16NgobH9Tnt8Qgzda/deF6drf8Vmrn3XL2xsr17OLOW9cG/1D+Ynrz+OJ+i3toteV6tjnCZkn1BG5jtrz8+E7YZLRyt63bUA6tmz0/DM9ozcM53H04j9/nl+f3Xx6Vj0WP9nc/+/fmic34dEE826WW2S++Wez+ppqUy6fh4exRcet09vP47Xm4aixv1HpOdHnn5Tfu9ZNYs6Nbp3HW3u9h+OC0vof2cV4wW4R73Bk1T702SybhMO7tF1+Lh1ddwtZ7nF64TZc/n6Arb9VsfOKyqL6AhmdI4zdF5ePR8fxBeak53nljUv9uuOGNDw+L8tuk8LTqb9659T+Lyaf78Ua/DuujgvA06HFYsWTX3Pl0ud/sJ5/eidez7f2qD6p7aB/oePm0btVk5x/jbRbbNEvK97uf3vzB6WRxUN9q9rhwm8SfWxqm6/L3urr+UTHlH2Ypt66L2QfFsH+fkXy6HmbjdTjf978kXQ+z9DKFWcotzFJuYZZyC7OUW5il3MIs5RZmKbcwS7nVNjspNvwQy4biT27Nw1+OWvsRrYt/NXvLStVk5RVBJvVf34rvN/ydRHr5WjE7mp/dPJ5PO5qdrr7czNqHmxc+9ybhJ16Wss/rn7at3pfLi/C3H593F3S9a5v91Uk0O/tJx7WXf5x9/k3iS9hMFz+vvtd+/38n5Zvn/hdF172169mzrq8MF288gNl4AM1RND+N037xmgdcGrzsbTIbXhvmw8Mi/Pjh7mn4K1PLL8eToqi/do+rl6ILvx0e+caLV6Y723/zaHHRGW9f3mY0iT+PcLb/50X86fHlwnpp8+MK0+oiIN7T+eEfHBbxB3aq93H2Z1wavOxtfJwNX6DjF+kP4stYLH/O8OzV0/mvPgxXpfGnBYvR7J3j+OBZfziPl7XND78u7nAyitfJO8flTcOty/81C9drm50Wr56EH+9q3scZlwYvfZuvDSbh8XUvvKrLtPop1hpX9cPWQV78Er5fv+DGQfNhdZtR+yJgvFf9RG18dc+l2emWZyja+03rn/pu3ocZlwa02Wz5bvoXf3L8yXF8DYLwui/he/b489XxK/xoUtOqv1uatKTFd8sV5aPrNL5812jlcXa6vN5YuTZoX882j7mtx14uDWjb92DjvQ9Oxl8rHx/jw1v7adVyEMjt1I+z9VfsneN1s82K2VG8m0pvy+yW1wSNlyST5nVBRvGImvdzLg1ovtXsNL6S4Kh+HYPJ4nr2n8IraZTkzqvXExzFS93pQfNhvE18Xbrlw2i8m/AjhpNoNrxWV/mgWy+8eEDlA/ACfHwVm73ley4NaL5udtJcY4bXDIyvGzhfed7gLLx0wXl4SqF6fr8Yhfd7zdP99Qtf/f7KE/+zvz+pfv/b+/FPscbhV/E1a4uNL3hc/TlY9X3fuL5N855LAxri7xt0eJqWqEeYpdxKbjZcPoCWBoy/i0i5hVnKLcxSbmGWcguzlFuYpdzCLOVWseXXFPu9svvrdV18YeFlFtPWMCsLZv9rre5m11deZjFtDbMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWRlmDcOsDLOGYVaGWcMwK8OsYZiVYdYwzMowaxhmZZg1DLMyzBqGWdnVmb2/qa/2f+K6hVnZFZrlQXpbmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xh19/s/U11XbzRbNd7xOwwvQRm+5z8jWY33OHGe8TsMGFWhlnDMCvDrGGYlWHWMMzKMGsYZmWYNQyzMswahlkZZg3DrAyzhmFWhlnDMCvDrGGYlWHWMMzKMGsYZmWYNQyzMswahlkZZg3DrAyzhmFWhlnDMCvDrGGYlWHWMMzKMGsYZmWYNQyzMswahlkZZg3DrAyzhmFWhlnDMCvDrGGYlWHWMMzKMGsYZmWYNQyzMswahlkZZg3DrAyzhmFWhlnDMCvDrGHXy+zGf+nAy+wL+ccYrnfXzOymE+1lttfir/6ZuU5hVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyrqb7fqvj2C2d5iVdTfbY4bZy4VZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzArw6xhmJVh1jDMyjBrGGZlmDUMszLMGoZZGWYNw6wMs4ZhVoZZwzC7XLwhM7OdG/jzfLVhVi42M9t554E/z1cbZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxhmJWLMWsYZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxhmJWLMWsYZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxhmJWLMWsYZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxhmJWLMWsYZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxhmJWLMWsYZuVizBqGWbkYs4ZhVi7GrGGYlYsxaxhm5WLMGoZZuRizhmFWLsasYZiVizFrGGblYswahlm5GLOGYVYuxqxh2Zq9v7Gu57Tr4hdktsf/Fczm0wByNsxekNnki6/67AwaZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOGYVYOMWsYZuUQs4ZhVg4xaxhm5RCzhmFWDjFrGGblELOG2Zm937UXcvIxm+L0Jd7Dz6zVycdsitOXeA/MyiFmU5y+xHtgVg4xm+L0Jd4Ds3KI2RSnL/EemJVDzKY4fYn3wKwcYjbF6Uu8B2blELMpTl/iPTArh5hNcfoS74FZOcRsitOXeA/MyiFmU5y+xHtgVg4xm+L0Jd4Ds3KI2RSnL/EemJVDzKY4fYn3wKwcYjbF6Uu8B2blELMpTl/iPTArh5hNcfoS74FZOcRsitOXeA/MyiFmU5y+xHtgVg4xm+L0Jd4Ds3KI2RSnL/EemJVDzKY4fYn3wKwcYjbF6Uu8B2blELMpTl/iPTArh5hNcfoS74FZOcRsitOXeA/MyiFmU5y+xHtgVg4xm+L0Jd4Ds3KI2RSnL/EemJVDzKY4fYn3wKwcYjbF6Uu8B2blELMpTl/iPTArh5hNcfoS74FZOcRsitOXeA/MyiFmU5y+xHtgVg4xm+L0Jd4Ds3KI2RSnL/EelzDb65936PxPe3id/GtkdvNnu9ep2rS449H06TJm+xzOFZ6/Pouvk9mNi3udqtRIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpGGblELNq59RIOoZZOcSs2jk1ko5hVg4xq3ZOjaRjmJVDzKqdUyPpWF+zqf9pD7OTj1m1c9fFGzV1/EdFNtTXbOfPYp6LMat27rq4syYNsAmzcohZtXMfipgdajFm1c59KGJ2qMWYVTv3oYjZoRZjVu3chyJmh1qMWbVzH4qYHWoxZtXOfShidqjFmFU796GI2aEWY1bt3IciZodajFm1cx+KmB1qMWbVzn0oYnaoxZhVO/ehiNmhFmNW7dyHImaHWoxZtXMfipgdajFm1c59KGJ2qMWYVTv3oYjZoRZjVu3chyJmh1qMWbVzH4qYHWoxZtXOfShidqjFmFU796GI2aEWY1bt3IciZodajFm1cx+KmB1qMWbVzn0oYnaoxZhVO/ehiNmhFmNW7dyHImaHWoxZtXMfipgdajFm1c59KGJ2qMWYVTv3oYjZoRZjVu3chyJmh1qMWbVzH4qYHWoxZtXOfShidqjFmFU796GI2aEWY1bt3IciZodajFm1cx+KmB1qMWbVzn0opjIb+3qRVRzukFkd7iazVV/vht0lDnfILA8Xsy82Drd/mH2xcbj9e873XUR2YZZyC7OUW5il3MIs5RZmKbcqs1++d/sP3y/fP349vLl9+635/OkP48Sy6nDbb7M53PjR3QwOt2Sw/Lx6HW5l9rfvzz/67uflYZZmn/3V+0//8v3w9kcfX/HBbas63PbbbA53/uzt+nNsfrhP/y48glUHana4i2uDeFDhcbY6xi9eL/97u3uVR6arPoeLt9kc7pfvlV/D5nkc7hdv1QdqdrhLsz/+vDL75XuvlwcbfvXRW1d5ZLp4uMu32Rzu0x/9bfnFLIvD/fJn8/pAzQ53YfaLcEzxejZ+9Xr8ltVhXige7vJtNof7+I//8+kP7+ZwuM/evt18Xs0OtzH77G/CA0E0+9t/fu+7n5sd5nrV4S7fZnO4lgjWqw53/viPPrY83Mbsf8RL7Hg9++PP/S5h1qsOd/k2m8OtvsxmcbjzZ3/9sfP17OO78/IbxcX3YG/fDd8qxmswy6rDbb3N5nCrp2RyONz4QFAdqNnhVmY/un07PBv3xe3wZJf/87PV4bbfZnO44XN8N4fP7uNowfj5WaJ8wizlFmYptzBLuYVZyi3MUm5hlnILs5RbmE3U+WFRFLun+kaTgxdzMNc7zKZpUpQcZ0c7x+pG54eYTRBmk3S2HzWeH8pHWswmCbNJGt84ie//O5CdlFcJ8VF3L/zO7uns6GAcrhvO9ouivh31CLMpWnl8HZcXCOFxt2W2GJU32eNxNk2YTVEA2VRdJkx2jltmg+jyF5hNEmZT1DY7jd+Hne2PWmbrX2A2SZhNUfVIWoXZocNskprvwSbFqDI7LTA7VJhNUv1cV3i8Xb2eDRPMpg2zaWr9mUL1vMFe9eA7LTCbOswmKjz5Wv/Zbf38bEm4KPYmLbPl7/D8bP8wS7mFWcotzFJuYZZyC7OUW5il3MIs5RZmKbcwS7mFWcqt/wd6CttVCUcw8wAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /> the discrepancy variable is the total number of state “1”s predicted, represented by <code>type = &quot;sum_one&quot;</code>. Here, the <code>output</code> and <code>file</code> arguments are defined similarly to the <code>convergence()</code> function. The <code>burnin</code> argument indicates the number iterations to discard based on the convergence assessment. The <code>type</code> argument accepts one (or more) of the following in vector form: <code>&quot;sum_one&quot;, &quot;avg&quot;, &quot;var&quot;, &quot;tran01&quot;, &quot;tran10&quot;, &quot;tran00&quot;, &quot;tran11&quot;</code>, representing the discrepancy functions for the total number of state “1”s predicted, the mean and variance of average proportion of state “1”s predicted per subject, and the total number of transitions predicted for <span class="math inline">\(0\rightarrow1\)</span>, <span class="math inline">\(1\rightarrow0\)</span>, <span class="math inline">\(0\rightarrow0\)</span> and <span class="math inline">\(1\rightarrow1\)</span>. In this tutorial, we present results from <code>type = &quot;sum_one&quot;</code> (Figure above). The plot generated by this function is a histogram of the total number of state “1”s generated from the posterior predictive distribution calculated with the parameter values at each MCMC iteration. The dark blue line represents the total number of state “1”s observed in the dataset. This plot indicates good model fit, as the 2-sided p-value for rejecting the goodness-of-fit is over 0.8. Sampling the posterior predictive distribution of the discrepancy variable can take a long time. Hence we make the <code>ppc()</code> function output the posterior sampling data matrix, in this example, to <code>ypost</code>. If we need to make different types of PPC plots using the same output object, simply put this posterior sampling data matrix to the <code>postsample</code> argument, e.g. (<code>postsample = ypost</code>), that will save some computational time. For example, we can run the following to generate the plots for all other discrepancy variables listed:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">ppc</span>( <span class="dt">output =</span> hmmout, <span class="dt">file =</span> <span class="st">&quot;ppc_plot.pdf&quot;</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;avg&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;tran01&quot;</span>,</a>
<a class="sourceLine" id="cb15-2" title="2">    <span class="st">&quot;tran10&quot;</span>, <span class="st">&quot;tran00&quot;</span>, <span class="st">&quot;tran11&quot;</span>), <span class="dt">burnin =</span> <span class="dv">1000</span>, <span class="dt">postsample =</span> ypost)</a></code></pre></div>
<p>Currently the <code>ppc()</code> function only works for the HMMs.</p>
</div>
<div id="posterior-inference" class="section level2">
<h2>Posterior Inference</h2>
<p>Having checked convergence and fit of the model, we now demonstrate how to draw inference from the MCMC output for variable selection using the following function</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">out =<span class="st"> </span><span class="kw">selection</span>( <span class="dt">output =</span> hmmout, <span class="dt">burnin =</span> <span class="dv">1000</span>, <span class="dt">cred =</span> <span class="fl">0.95</span>, <span class="dt">threshold =</span> <span class="fl">0.5</span>, <span class="dt">trueGamma =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb16-2" title="2">                <span class="dt">plotting =</span> <span class="ot">TRUE</span>, <span class="dt">file =</span> <span class="st">&quot;mppi.pdf&quot;</span>)</a></code></pre></div>
<p>The <code>selection</code> function requires the model output (<code>output = hmmout</code>) and the number of MCMC iterations to treat as burn in, (<code>burnin = 1000</code>). The <code>out</code> object contains the marginal posterior probability of inclusion (MPPI) for each of the corresponding regression coefficients, as well as a dataframe which includes the posterior mean of the regression coefficients and their credible intervals. By default, a 95% credible intervals is generated (<code>cred = 0.95</code>), and an MPPI threshold of 0.5 (<code>threshold = 0.5</code>) is used to determine inclusion in the model. The MPPIs and tables for all of the regression coefficients in the full model can be extracted using the following code,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">mppi =<span class="st"> </span>out<span class="op">$</span>mppi</a>
<a class="sourceLine" id="cb17-2" title="2">table_full =<span class="st"> </span>out<span class="op">$</span>full_table</a></code></pre></div>
<p>To extract a table with only the selected regression coefficients, run</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">table_selected =<span class="st"> </span>out<span class="op">$</span>table </a></code></pre></div>
<p>The <code>mppi</code> object is a numeric vector containing the MPPIs for all the terms in the model. The first five rows of the <code>table_full</code> object, extracted using the <code>head()</code> function in R are</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">head</span>(table_full)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt;             MPPI    Est CI_2.5 CI_97.5</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt; baseline01 1.000 -0.165 -0.725   0.365</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt; t01_tVar1  0.751 -0.644 -0.986  -0.322</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; t01_tVar2  0.007 -0.132 -0.317   0.162</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt; t01_tVar3  0.003 -0.221 -0.302  -0.157</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">#&gt; t01_tVar4  0.000    NaN     NA      NA</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt; t01_tVar5  1.000 -0.808 -0.996  -0.614</span></a></code></pre></div>
<p>In this table, <code>Terms</code> indicates the name of the corresponding covariate as well as its location in the model, similar to the format used to label the trace plots. Intercept terms’ estimates, which can be interpreted as baseline log odds/hazards, are labeled as “baseline<em>xy</em>”, where “<em>xy</em>” takes on values of either 01, 10, 00, or 11 indicating the direction of transition or emissions the term represents. <code>MPPI</code> indicates the marginal posterior probability of inclusion for the corresponding term, empirically estimated as the average of the inclusion indicators across MCMC iterations. The posterior mean estimates, <code>Est</code>, are interpreted as log hazards or log odds ratios, depending on if the covariate is included in the transitions or emissions part of the model. Note that an MPPI equal to one indicates that the covariate (or intercept term) was forced into the model as specified by the user, or after burn-in, the algorithm never excluded the term from the model. Also, the posterior mean estimates and the credible intervals are calculated using samples with corresponding inclusion indicator equal to 1. Hence if one term is never included (e.g. `<code>t01\_tVar3&#39;&#39; in our example) in the model, both the estimated and the credible intervals will be shown as NAs. The</code>table_selected` dataframe is structured similarly, but only contains terms that were selected based on the given MPPI threshold.</p>
<p>If the <code>plotting</code> argument in the <code>selection()</code> function is set to <code>TRUE</code>, a plot of each term’s corresponding MPPI for each part of the model (i.e., transition <span class="math inline">\(0\rightarrow1\)</span> and <span class="math inline">\(1\rightarrow0\)</span>, as well as emissions <span class="math inline">\(0\rightarrow0\)</span> and <span class="math inline">\(1\rightarrow1\)</span> is generated and saved as a pdf (<code>file = &quot;mppi.pdf&quot;</code>). For example in Fig., “MPPI01” indicates the transition from 0 to 1 and, “MPPI00” indicates the emission from 0. A horizontal dotted line at the given MPPI threshold is plotted against the estimated MPPIs to help users visualize which terms are included and excluded in the model.</p>
<p>In simulation, the true associations are known and can be compared to the selection results. To visualize the selection performance of the model in simulation, the <code>selection</code> function accepts a dataframe of the true associations (i.e., inclusion indicators equal to 1) and plots them as red dots against the corresponding MPPI, as seen in Fig.. To extract the true associations from the simulated data and include them in the MPPI plots, run</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">truegamma =<span class="st"> </span><span class="kw">findtruegamma</span>( <span class="dt">data =</span> df, <span class="dt">output=</span>hmmout )</a>
<a class="sourceLine" id="cb20-2" title="2">out =<span class="st"> </span><span class="kw">selection</span>( <span class="dt">output =</span> hmmout, <span class="dt">burnin =</span> <span class="dv">1000</span>, <span class="dt">cred=</span><span class="fl">0.95</span>, <span class="dt">threshold =</span> <span class="fl">0.5</span>, <span class="dt">trueGamma =</span> truegamma, </a>
<a class="sourceLine" id="cb20-3" title="3">                <span class="dt">plotting =</span> <span class="ot">TRUE</span>, <span class="dt">file =</span> <span class="st">&quot;mppi.pdf&quot;</span>)</a></code></pre></div>
<p>For an MSM model, the process is similar. For example, the transition estimate tables and corresponding MPPI plots for an MSM model can be generated with the following code.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">truegamma =<span class="st"> </span><span class="kw">findtruegamma</span>( <span class="dt">data =</span> df1, <span class="dt">output=</span>msmout )</a>
<a class="sourceLine" id="cb21-2" title="2">out =<span class="st"> </span><span class="kw">selection</span>( <span class="dt">output =</span> msmout, <span class="dt">burnin =</span> <span class="dv">250</span>, <span class="dt">cred=</span><span class="fl">0.95</span>, <span class="dt">threshold =</span> <span class="fl">0.5</span>, <span class="dt">trueGamma =</span> truegamma, </a>
<a class="sourceLine" id="cb21-3" title="3">                <span class="dt">plotting =</span> <span class="ot">TRUE</span>, <span class="dt">file =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArMAAAKzCAMAAAA6OXUpAAABU1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6kLY6kNtNTU1NTW5NTY5NbqtNjqtNjshZWVlmAABmOgBmOjpmZjpmkJBmtpBmtv9uTU1uTW5uTY5ubk1ubm5ubo5ubqtujshuq6tuq8huq+SOTU2OTW6OTY6Obk2ObquOjo6OjsiOyMiOyOSOyP+QOgCQZraQkDqQtpCQttuQ2/+rbk2rbm6rbo6rjk2rjo6rq8irq+SryKuryMir5P+2ZgC2Zjq2kDq225C22/+2/9u2///Ijk3Ijm7IjqvIq47Iq6vIyI7IyOTI5KvI5OTI5P/I/8jI/+TI///bkDrbtmbbtpDb///kq27kq47kq6vk5OTk5P/k/8jk///r6+v/AAD/tmb/yI7/yKv/yMj/25D/27b/5Kv/5Mj/5OT//7b//8j//9v//+T///8/rTy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAebElEQVR4nO3d+3sc51nGccU0R4rXNo452XGLm8o2tEGhECWUg1wCFoe0QGWISkGRlxoVyzv//0/MzO5Ku5J23mc0995z2O9zXY1l+fbc7858NJ4drbZbGcP0a7baXgDD1BzMMn0bzDJ9G8wyfRvMMn0bzDJ9G8wyfRvMMn2b65t99u0/n330H797M8tebJXzreKTCx+/+fTtr7Psf39na+vbfzf/i+80XTSz0dPA7NZbn5UfvHpv69zs1tb9pY9Ls6/vFb+58byMv9jCLNNkGph96zdvlh+8+I33CrNTkv++lRtd+Lg0+2Lrt75+87eF7OzNT7YwyzSaBmZv/Kj4Zz8/k/7+gtn8088XPy7MTq8PZmfct/7gHmaZJtPE7JfvFxcHrz74MmH29VRp8Sev/3T+O4a55jQx+/efFv/aP3vn1dK1wTtLHxdmyz/PPzu9/sUs02yamH3+rPzX/v7U7OxpVwFz4WPMMuppZPZlrvDljeeLZss7WgsfY5ZRTyOzr+/dLO62Ll4blLPw8fR69ubsLxS/YJZpNo3MFs/D3rufNLtw3yDDLNN0mpl9+dbv5f9Nmc2eFfdnf7I1vZ2LWabZNDP7+l5xmyBpdun7YJhlmk0zs/kZ9H7AbPl6g2/NXm+AWabZ8Loupm+DWaZvg1mmb4NZpm+DWaZvg1mmb4NZpm+DWaZvg1mmb4NZpm9zbbPfXD2rPr/OWBudHV7aYHcHZi2xTenEbM3YYA9SfzoxWzM22IPUn07M1owN9iD1pxOzNWODPUj96cRszdhgD1J/OjFbMzbYg9SfTszWjA32IPWnE7M1Y4M9SP3pxGzN2GAPUn86MVszNtiD1J9OzNaMDfYg9acTszVjgz1I/enEbM3YYA9SfzoxWzM22IPUn07M1owN9iD1pxOzNWODPUj96cRszdhgD1J/Onts9riY9Jq0sd4fpOjj7G5nbGtNO9dh9ng+gaXLYqsfYhdigVT8cXa1M7a15p1rMHt8HFqWNlbxELsQS6dqPM6Odsa2JujUmz0+Di1LG6t6iF2IJVN1Hmc3O2NbU3SGzJ48PCh/PX08unN09gtm4zHMCjsjZsej26XZye5Odnh3/ssKs8fHoWVpY5UPsQuxVKrW4+xkZ2xrks6A2f1bfz09z54+PShOubNfMFsjhllhZ51rg5NHR9npk73ZL/kn3s3nYvbCqlZtUhvr/bTxOLWdsa1JOyNmx3dKrLNfZn92za8kbazyy7ILMc6zws46Zi+dZzHbTT9tdHbUbOh6lvsG10rVeZzd7IxtTdFZx+xkd3t632C74r4BZq+Vwmy8M2y2+F/o/izfB7tWqsbj7GhnbGuCzpDZqqlaVvAxSmKrH2IXYrzeQNi5DrO8rut6qejj7G5nbGtNO9dj9sN8AmvSxnpvNvo4u9upPZ6YbTWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+xsbPbKKVZlj/V+2nic2k7v8eQ8u9YY51lhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLATs5YYZoWdmLXEMCvsxKwlhllhJ2YtMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZi1hLDrLAzYPb08ejOUfHB4aiYnfLX2weYrRHDrLAzbXaymyu9O//dOOe7v8N5tmYMs8LOtNnTpwfZycPZafX0yV42+XwPszVjmBV2ps2ePDoqqZZTnHDza4XiCiGfd/O58u8Uq1q5wXXFej9tPE5tp/d4rjZbXA3MzZa/nny0eK5t8pXEeXZpOM/GOtNmF8+z4+mTsXzOrmmbrAqzS4PZWGfa7OL17P72/LOYrRXDrLAzbXayuz2/bzC9IihOtpMvuNdVJ4ZZYWfa7Oz+bHGqnV0iHI5Gt85uHTRZFWaXBrOxzoDZ6mmyKswuDWZjnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYWdjs1dOsSp7rPfTxuPUdnqPJ+fZtcY4zwo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWHnJbOv723N58ZzzIpimBV2cp61xDAr7MSsJYZZYecVZp8FrwowG49hVth52eyzt7/OXsTRNlkVZpcGs7HOS2bffHp/9h/M6mKYFXZeMvv6Xmn2JmaVMcwKOzFriWFW2IlZSwyzwk7MWmKYFXZeYZbvg+ljmBV2XjJbd5qsCrNLg9lYJ2YtMcwKO68we/H7YKePR3eOyo8OR6PR7YOFT2C2u342yezF74NNdneyw7vlh/s7Fz6B2e762SCzl74Pdvr0IDt5eFBg/Xxv+RPlX5zNfIPz33944fcX/3y++Ko/r/n7rOHfX/591ng9dX9fHkvd9rJIPrz/s8SfT7cmPZ7lI7jizy+ZvXSv6+TRUXb6ZG96kTAa7Sx84t18zh7TBcMfXvj9xT8vPl40e9Wfb9jvi93h7tfuf8/xPPtw/sEls+M7c6InH+0V59rzTxTzzVXDtcF1UlwbxDrTZs9Pq+Xs7yx/osmqMLs0mI11ps0uX77mZpc/0WRVmF0azMY6rzA7v4KY3fGa7G7PbhMUFwWTLw7OP4HZDvvZILOXZ3o7tjizHo5Gt/Yy7s/Wj2FW2BkwWz1NVoXZpcFsrBOzlhhmhZ2YtcQwK+y8ZPbNpxeeg2FWEMOssPPyefbl1lb4Bxgx210/m2Q2K1/Zxc/dYvZaWzN0Xml2eoUQY9tkVZhdGszGOleYLdlyPSuLYVbYufo8+9ZnnGdlMcwKO68yGweL2e762SSzL2uAxWx3/WyQWe7PriOGWWHn5fNszWmyKswuDWZjnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2NjZ75RSrssd6P208Tm2n93hynl1rjPOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7A2ZPH4/uHJUfnTwYjXay7HA0Gt0+wGyNGGaFnWmzk92d7PBuiffJXnby0V62v8N5tmYMs8LOtNnTpwfZycPitDou5O7vTD7fw2zNGGaFnWmzJ4+OyjPsTPCTvfxaobxEyLJ387ny7xSrWrnBdcV6P208Tm2n93iuNju+s2B2srtdXh6cn2ubfCVxnl0azrOxzrTZxfPs6ePt2WfPrmmbrAqzS4PZWGfa7Pn1bHby4OzZF2ZrxTAr7EybLS4HpvcNZmSLi4XJF9zrqhPDrLAzbXZ2fzY/1Rb3ZYtnX/mvt85uHTRZFWaXBrOxzoDZ6mmyKswuDWZjnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYSdmLTHMCjsxa4lhVtiJWUsMs8JOzFpimBV2YtYSw6ywE7OWGGaFnZi1xDAr7MSsJYZZYWdjs1dOsSp7rPfTxuPUdnqPJ+fZtcY4zwo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYiVlLDLPCTsxaYpgVdmLWEsOssBOzlhhmhZ2YtcQwK+zErCWGWWEnZi0xzAo7MWuJYVbYORyzx8V0MxbcWHB3dLdTa3Zl51DMHs+ne7HgxoK7o7ud30jNVnQOxOzxcWi/thELbuybml+bneucbS21MUHnMMweH4f2axux4MaKqfe12bHO+dYSG1N0BsyePh7dOVr86PwTmO2kn403O9ndyQ7vLnx0/omumD0+Du3XNmLBjZVT82uzU51nW6vemKQzbfb06UF28vDg/KPzT2C2k34we/LoKDt9snf+0fkn3s1n5d8zzoWH2KVYcGPB6W6ndmKdq82O78yJzj46/0QxK75SrDfuLzzELsWCG5tNand0tzO6NUVn2mzFeRaznfSD2etcz7q/QRrcq23E6hzw9O7obmd0a4LOtNnJ7vbZfYPt6X2D7dR9A8zW3dh0MBvpTJud3Y4tzqzh+7P2F6IE92obsRoHPLA7utsZ3VrzzoDZ6mm0dl0suFfbiMUPeGR3dLczurXGnUMxO4TXdQV3R3c7o1tr2Dkcs/1//ewAOi1Lw6wltimdmK0ZG+xB6k8nZmvGBnuQ+tOJ2ZqxwR6k/nRitmZssAepP52YrRkb7EHqTydma8YGe5D604nZmrHBHqT+dGK2ZmywB6k/nZitGRvsQepPJ2ZrxgZ7kPrTidmascEepP50YrZmbLAHqT+dmK0ZG+xB6k8nZmvGBnuQ+tOJ2ZqxwR6k/nRitmZssAepP539MLtigu8vI4210dnhpQ1+d2B2rbFN6cRszdjgD1L3O3ttlmHWPZhl+jaYZfo2mGX6Nphl+jaYXe/8+l/bXsHKUS7t5Hu6bSVHbPYXe+lMOHby4PZBOhXtHI9G26HS8/d+rNpaKBXcWmxpwZXJl7YT2VboSI1HtyLH6uRBdUxsdj+0qFhsfPtgPLqbzsU68yN58iC9+/PS/cixjB3xSGN0adGVqZf2f38T2NYnT2IH9DBgu9wdVcddbPbwuyFAkdjk873iLW/TaEOd5dYOkxsrYsX7mSfn9I//Ii2jcDHZTZ1DY0sLr0y5tGw/h32Y2r35tor/H67UFI+gfKzpWFaJVn2e3RlH0IZixf7K0Sb/1QxtrPw/ghgnzZ4+3sn31yh9ep98kZ/1/vuHidTh3Xz9qfNebGnhlSmXlu1vT3Zvf1VdWqwscDoo3yc+8AjKzU1+/Eerj7vQbH5R8/N/PMgCgCbpWH6ROi7/HTn5qCqXxwIbK2LFTk3ByGP/+Un2D3vT/VaRyidP7Y9+WHHeK2KT3R9sZ9Vby7LQ0rLIymaTXFoxsaWNb//se+lUPuf/RxsVmQfF9WzylHyYfx2N71ZsUGf27PIzjXbyl8lYcZE6vXzbr3qI82vZROcsluOoPG+fXxkfJlOHO0tv1b8iNr1qrNpaNt0dqaXNdlpyW0UsubQyFlvag/LyIf0AipNoavLOR0eBR5Cfi4ujv/K4y8wuXH6OE081839uDlKx8iJ1P89Vf1meXctWd85ih9vVLs6vjKu+UKap8cf5yWe/4uy4cJld+WU33R2ppc13WmJbZSy5tPOtJZd26ztFMPAAqv89nMW+Sm9svrSKK1/deTZ6+Zmv5g/T/45ML1L3R4nLn3rXz4cfVy9vGjt9/HHlM79pKvm8e9aZ2tpsd6SWVqaS25rG0rcEpp2xpSWPwex4pm5qzDb2SeQRZId/srs6Jr02yFKXn+X8+p/St/wiF6n1Y+Pq58mz2K9+VvkYanb+6qtEdro7EkubphIry2L79iwWXFpsY9nkn6u/RzF7nKk9V8ZOf1z1ZSd8Dha4/MzK/8Om0Q+SuyJwxXuN2OlfCbamXdp8d1QvLbbTWom10Km815W+/MzKPx8nlxW54m0ppu6M7Y5IqpVYG50qs8UXyN3Epc+4vImRnT79KrGs0BVvOzHhxmK7I7jT2oi1srRMZrb4Akk+/ypCJw9/vrsz2a2+qq91VeaNCTcW2x3BndZGrJWlZTKzJ4+OTh/vpO68FXeLi6+lyRepk1Dq39QWY7qNxXZHcKe1EWtlaTqzD/8teU9w9l3KfGmVtourjJ30IW8jpu2M7Y5gqpVYK0vTXc/uF0codc+g/C5l4tQ/vQxPHvI2YtrOLLQ7wqlWYq0sTWB2elbJu6qef81eIZp4YdLCZXjV4W4jJu6M7Y5QqpVYK0ubT3Oz+7MzSlXj5KfFCyS2i9cJVW1qU55vxHZHdKe1EGtlaWfTyOx4Z3ZTJ/XP4MmD73++VxzGxMt/NuT5Rmx3BHdaG7FWlnY2TcxOdu8cTX5Rck0/e/n+f2XFVW91blOeb8R2R3SntRBrZWnzaWD2f/bOnm4k5/CTwItnso15vhHbHcGd1kaslaXN5/pmJ7u39sqzbOyGZeI7DhvzfGM2kRfARVOtxFpZ2nSaXBtMXyoVR/vbq1+LsDHPN86mcnfUTLUSa2Vp5TR7DjZDG5vTx3d/uerPNub5xvlU7Y66qVZirSytmAZmixuzozpoqze2Ic83mMbT5Hq2eFnMKPEThtHZhOcbsd0hfVsTbayVpV2e65udvixmv+qssvxuGafVP748/Ocbsd0R3GltxFpZ2uVpYDb9spild8s4ffov1T8wNPjnG7HdEdxpbcRaWdrlaXA9m35ZzOJPGAbuAQ39+UZsdwR3WhuxVpZ2ea5ntnzXnOqXxVx4h44Vi9qYi7fY7oilWom1srSr51pm5+8rUlF14R06ViWV70knjkk3FtsdwZ3WRqyVpa2Ya5k9LE+yVT/PfuEdOlYuavmaZuVleBsx5cZiuyO409qItbK0VXM9s8VFQfVP2AbfoWP5mmblZXgbMfHGssDuCO80f6yVpa2Y+maLbyV8Nz/HVr8tY+wdOiaxa5o2YtrO2O4Ivq1JG7FWlrZiapudvZTrl1V3uSY/DbxDx9l7Q1df07QR03bGdkcw1UqslaWtntpmZz85Uvlu6uX33hPv0LHwLt5V1zRtxLSdsd0RTbUSa2Vpq6e22dCPoJffe698h44L7+IduFq3xbSd5Z8ld0c81UqslaWtnGs8Bwv8CHrgW/Qb83wj6/TrqDu8tJUTNjvemb6/UexH0NPHcmOeb5TT4ddRd3hpKyZqNr8a2NkvfiT8buhH0FPfe8+vwyOX4W3EtJ3z6fDrqDu8tKsnfm0wHhXnlcj7+U+n8nvvxXX4d9KX4W3EtJ1n0+HXUXd4aVdOjevZ6Yu705cFoSmuwwOX4W3EtJ2MfOo8BytvQ17zntrF2ZgnHIx8at03GCtPKxvzhIMRT717XZqf/ZrNxjzhYLTT5v+v+MY84WCk06ZZhrnOYJbp22CW6dtglunbYJbp22CW6dtglunbYJbp22CW6dtgdn3z5tOt6bzT9kqGNZhd77x6/7O2lzC4wex6B7P6wex6Z2a2uEy48Tx79cGPtm58+f6fvbe1dfNV/p/7eSD/pfiVCQ9m1ztTs28+zS9pX7z99av33imUvv119mKr+M+N5+Wfv3oPtDUGs+udqdmX+Tk2e33vfolz4T/vf/bqg+dtL7F3g9n1ztTsi+n9g5vTs+rSf55xW6HuYHa9MzObXwic/e7Cf/Lzb3Gpy4QHs+ud2bXBW5+d/+6i2fKqocUl9m4wu96ZPwfLT7Q53MtmyytdbojVGsyudxbudeXn2ivOsy+3yj9h4oNZpm+DWaZvg1mmb4NZpm+DWaZvg1mmb4NZpm+DWaZvg1mmb4NZpm/z/wZqAq5RAWBjAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /><img src="data:image/png;base64,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OguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOolhmZ6+tqrl0WNI2c6TlGI7hV+twuM6Caa6zXSj3BnFhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiuLNnj0d3XlYPjkdV7dWfbx/pbHCaznahejg72S8tvTv/alzqe7jnOhuVprNdqB7Onj09Kk4fzpbVsycHxeTTA52NStPZLlQPZ08fvaxVratacMu9QrVDKOvdsq79N1VzSwOjsbBKGpala2mPYPDVOhzLna12A3Nn68+nHy6utXE/Ip0w19kObbrOzpwdT0/Gyjrf08Y11wnT2Q5tbrWzi/vZw935szobkaazXahe1w1259cNpjuCarGdfOa1rvA0ne1C9b8+Wy21sy3C8Wh06/zSQVxznTCd7dDmdjvbXHHNdcJ0tkObOquzfdJ0tguls3FhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2KZnb22qubSYUnbzJGWYziGX63D4ToLprnOdqHcG8SF6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqJYYmdf39uZ143nOpskTWe7UK6zcWE6i2I6C4TpLIold/ZZ4K5AZ0PTdLYLFeHss7e/KF6ESxvXXCdMZzu0uU3Ovvn4/uyDzqZK09kuVMx1g9rZmzqrsxims0CYzqKYzgJhOotiOguE6SyK+ToYEKazKOZrCkCYzqKYzgJhOoti+OtgZ49Hd17Wj45Ho9Hto4UndFZnu2D062CT/b3i+G798HDvyhM6q7NdMPp1sLOnR8Xpw6NK1k8PLj9R/8NZzQPnX39w5eur35/3qun7UV/PDjFV3nzAkvWv/ev6CNLlFUn7V4TxS32I/3o6odd8/2vOfu1a1+mjl8XZk4PpJmE02lt44t2yzo/pisMfXPn66verx4vOXvf9qK+rsD7//mr/P/igX3/iv66PYIXtrfnX0wm95vvnD+cPvubs+M5c0dMPD6q19uKJqr68rtwbdAlzb3CperymcLGs1nW4d/mJuOY6YTrboc2tdvby9rV09vITcc11wnS2Q5vb5ex8BzG74jXZ351dJqg2BZPPji6e0Fmd7YThrylML8dWK+vxaHTroPD6bGyaznah+jjbXHHNdcJ0tkObOquzfdJ0tguls3FhOotiyV8Hu3IOprO903S2CxWxzn61sxP8B4w6q7NdMGBv8CxC27jmOmE626HNbXN2ukMI0zauuU6YznZoc/ucrbV1P5soTWe7UB3W2bc+cZ1NlKazXagoZ8OF1Vmd7YKlv24QLqzO6mwXzOuzQJjOopivgwFhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyiW2dlrq2ouHZa0zRxpOYZj+NU6HK6zYJrrbBfKvUFcmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMoprNAmM6imM4CYTqLYjoLhOksiuksEKazKKazQJjOopjOAmE6i2I6C4TpLIrpLBCmsyims0CYzqKYzgJhOotiOguE6SyK6SwQprMohjt79nh052X96PTBaLRXFMej0ej2kc4Gp+lsF6qHs5P9veL4bi3vk4Pi9MOD4nDPdTYqTWe7UD2cPXt6VJw+rJbVcWXu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" style="display: block; margin: auto;" /></p>
<p>An alterative approach for determining a covariate’s inclusion in the model is based on a Bayesian false discovery rate (BFDR) threshold, which controls for multiplicity. A BFDR is the Bayesian analogy for calculating the expectation of the type-I error rate. Hence, different inclusion thresholds map to different BFDRs. In <code>HMMbvs</code>, we provide a function that calculates thresholds corresponding to BFDRs from 0.05 to 0.5. Inputting the MPPIs estimated by the model in our example generates the following table</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">bfdr_tab =<span class="st"> </span><span class="kw">bfdr_wrap</span>( mppi )</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">print</span>(bfdr_tab)</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt;        FDR   Threshold Selected</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt;  [1,] 0.05 0.751333333       20</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt;  [2,] 0.10 0.427333333       22</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt;  [3,] 0.15 0.068666667       24</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt;  [4,] 0.20 0.016000000       25</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt;  [5,] 0.25 0.012000000       27</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt;  [6,] 0.30 0.007333333       29</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt;  [7,] 0.35 0.004666667       32</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt;  [8,] 0.40 0.002666667       34</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">#&gt;  [9,] 0.45 0.002000000       37</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">#&gt; [10,] 0.50 0.000000000       40</span></a></code></pre></div>
<p>where <code>FDR</code>, <code>Threshold</code>, and <code>Selected</code> represent the BFDR, corresponding threshold, and the number of terms selected at the given threshold. In this example, the median model approach obtained a BFDR of 0.10. For interpretation, we would expect 10% of the 22 selected terms to be false positives.</p>
<p>In order to visualize the estimated hidden states relative to the observed states, a plot of the proportion of matched states for the sample is generated using the following code</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">plot_hidden</span>(<span class="dt">output=</span>hmmout, <span class="dt">data=</span>df<span class="op">$</span>DATA, <span class="dt">burnin=</span><span class="dv">1000</span>, <span class="dt">subject=</span><span class="st">&quot;all&quot;</span>, <span class="dt">true_hidden=</span>df<span class="op">$</span>STATE)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this function, the model output (<code>output = hmmout</code>), corresponding dataframe (<code>data = df$DATA</code>), and number of MCMC iterations to treat as burn-in (<code>burnin=1000</code>) are required to generate the plots. Users can additionally set the <code>true_hidden</code> argument to a vector consisting of the true hidden states (e.g., <code>truth = df$hidden</code>) when available. By doing so, a plot of the proportion of true hidden states matching the corresponding reported states for all individuals (<code>subject = &quot;all&quot;</code>) is generated. Note that the proportions are sorted in descending order and hence the subject indices are relabeled and different from the original indices. This plot can be used to visualize the overall proportion of mismatched states in the sample. In the absence of true hidden state information (i.e., <code>truth = NULL</code>), a similar figure will be generated which presents the proportion of hidden states estimated by our model that match the reported states for all individuals.</p>
<p>To visualize the relation between the estimated hidden and reported state sequence at the individual level, simply change the <code>subject</code> argument. For example, by setting <code>subject = 134</code> as the follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">plot_hidden</span>(<span class="dt">output=</span>hmmout, <span class="dt">data=</span>df<span class="op">$</span>DATA, <span class="dt">burnin=</span><span class="dv">1000</span>, <span class="dt">subject=</span><span class="dv">134</span>, <span class="dt">true_hidden=</span>df<span class="op">$</span>STATE)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>the function will generate a plot similar to Fig., given the true, hidden trajectory. In this plot, we observe misreported smoking behaviors at time points 3, 9, 16, 19, 24 and 30. By using our model, we successfully caught 50% of the reporting errors. If the true, hidden states are unknown, setting <code>true_hidden = NULL</code> will suppress the plot of the true smoking trajectories. This function also works for HMMs only since the MSM model doesn’t have a hidden layer and the plotting will not be very meaningful.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
